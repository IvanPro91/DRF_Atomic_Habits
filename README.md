# Трекер Атомных Привычек

Этот проект представляет собой веб-приложение для отслеживания и формирования полезных привычек, вдохновленное книгой Джеймса Клира "Атомные привычки". Цель трекера – помочь пользователям приобретать новые полезные привычки и избавляться от вредных.

## Концепция

В основе приложения лежит модель привычки, описываемая формулой: "Я буду [ДЕЙСТВИЕ] в [ВРЕМЯ] в [МЕСТО]".

### Модель Привычки

*   **Пользователь:** Создатель привычки.
*   **Место:** Место выполнения привычки.
*   **Время:** Время выполнения привычки.
*   **Действие:** Само действие привычки.
*   **Признак приятной привычки (is\_pleasant):** Флаг, указывающий, является ли привычка приятной (например, вознаграждением).
*   **Связанная привычка:** Ссылка на приятную привычку, которая служит вознаграждением (доступно только для полезных привычек).
*   **Периодичность:** Частота выполнения привычки (в днях, по умолчанию ежедневно).
*   **Вознаграждение:** Чем пользователь может себя вознаградить после выполнения (доступно только для полезных привычек).
*   **Время на выполнение:** Максимальное время, которое должно быть потрачено на выполнение привычки (не более 120 секунд).
*   **Признак публичности:** Флаг, определяющий доступность привычки другим пользователям.

### Типы привычек:

*   **Полезная привычка:** Основное действие, которое может сопровождаться вознаграждением или связанной приятной привычкой.
*   **Приятная привычка:** Способ вознаграждения, который не может иметь собственного вознаграждения или связанной привычки.

### Валидация:

1.  Нельзя одновременно указывать **вознаграждение** и **связанную привычку** для одной привычки.
2.  **Время на выполнение** должно быть ≤ 120 секунд.
3.  **Связанные привычки** могут быть только типа "приятная".
4.  **Приятные привычки** не могут иметь **вознаграждение** или **связанную привычку**.
5.  **Периодичность** должна быть ≥ 1 раза в 7 дней (то есть, минимум раз в неделю).

### Пагинация:

*   Вывод списка привычек осуществляется по 5 элементов на страницу.

### Права доступа:

*   **CRUD операции** (Создание, Чтение, Обновление, Удаление) доступны только для собственных привычек пользователя.
*   **Просмотр публичных привычек** доступен всем пользователям без возможности редактирования.

## Эндпоинты API:

*   `/auth/register`: Регистрация нового пользователя.
*   `/auth/login`: Авторизация пользователя.
*   `/habits/user`: Получение списка привычек пользователя (с пагинацией).
*   `/habits/public`: Получение списка публичных привычек (с пагинацией).
*   `/habits/create`: Создание новой привычки.
*   `/habits/update/<habit_id>`: Редактирование существующей привычки.
*   `/habits/delete/<habit_id>`: Удаление привычки.

## Интеграции:

*   **Telegram-бот:** Для отправки напоминаний о выполнении привычек.
*   **Celery:** Для обработки отложенных задач (например, отправка напоминаний, обработка периодических проверок).
*   **CORS:** Для обеспечения возможности взаимодействия фронтенда с API.
*   **Автодокументация API:** Генерация документации (например, с использованием Swagger/OpenAPI).

## Технологический Стек:

*   **Backend:** Python (Django REST Framework)
*   **База данных:** PostgreSQL (предпочтительно)
*   **Кэширование:** Redis
*   **Очередь задач:** Celery с Redis/RabbitMQ
*   **Управление зависимостями:** Poetry
*   **API документирование:** drf-yasg (Swagger/OpenAPI)

## Тестирование:

В данном проекте уделяется особое внимание качеству кода и надежности функционала. **Покрытие тестами составляет более 80%**. Это достигается за счет использования комплексных юнит- и интеграционных тестов, охватывающих:

*   **Модели данных:** Проверка корректности создания, валидации и сохранения объектов привычек, пользователей и других сущностей.
*   **API эндпоинты:** Тестирование всех CRUD операций, авторизации, пагинации, обработки ошибок и прав доступа.
*   **Бизнес-логику:** Проверка корректной работы логики, связанной с типами привычек, валидационными правилами и взаимодействием между компонентами.
*   **Celery задачи:** Тестирование отправки уведомлений и других фоновых процессов.

Использование тестов гарантирует, что новые изменения не нарушают существующий функционал и обеспечивают стабильную работу приложения.

## Установка и Запуск:

Данный проект использует Poetry для управления зависимостями.

1.  Клонируйте репозиторий:
    ```bash
    git clone git@github.com:IvanPro91/drf_atomic_habits.git
    cd drf_atomic_habits
    ```
2.  Создайте и активируйте виртуальное окружение:
    ```bash
    python -m venv venv
    source venv/bin/activate  # Для Linux/macOS
    # venv\Scripts\activate  # Для Windows
    ```
3.  Установите зависимости с помощью Poetry:
    ```bash
    poetry install
    ```
    *(Примечание: Poetry также позаботится о создании `requirements.txt` при необходимости.)*
4.  Настройте переменные окружения. Рекомендуется использовать файл `.env` и установить переменную `DJANGO_SETTINGS_MODULE` в соответствии с вашим файловым путем.
5.  Примените миграции базы данных:
    ```bash
    poetry run python manage.py migrate
    ```
6.  Запустите сервер разработки Django:
    ```bash
    poetry run python manage.py runserver
    ```
7.  Для работы напоминаний и отложенных задач, запустите Celery worker:
    ```bash
    # Убедитесь, что Redis или RabbitMQ запущены
    poetry run celery -A drf_atomic_habits.celery worker -l info
    ```
8.  Для запуска всех тестов:
    ```bash
    poetry run python manage.py test
    ```
    *(Или более специфично, например: `poetry run pytest` если используется pytest)*

## Разработчик:

*   **Git:** IvanPro91
*   **Проект:** drf\_atomic\_habits
